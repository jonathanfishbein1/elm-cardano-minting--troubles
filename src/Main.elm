port module Main exposing (..)

import Browser
import Bytes.Comparable
import Bytes.Map
import Cardano
import Cardano.Address
import Cardano.Cip30
import Cardano.Cip67
import Cardano.Data
import Cardano.Script
import Cardano.Utxo
import Cardano.Value
import Html
import Html.Attributes
import Html.Events
import Integer
import Json.Decode
import Natural


main =
    -- The main entry point of our app
    -- More info about that in the Browser package docs:
    -- https://package.elm-lang.org/packages/elm/browser/latest/
    Browser.element
        { init = init
        , update = update
        , subscriptions = \_ -> fromWallet WalletMsg
        , view = view
        }


port toWallet : Json.Decode.Value -> Cmd msg


port fromWallet : (Json.Decode.Value -> msg) -> Sub msg


type Msg
    = WalletMsg Json.Decode.Value
    | ConnectButtonClicked { id : String }
    | Mint



-- MODEL


type Model
    = Startup
    | WalletDiscovered (List Cardano.Cip30.WalletDescriptor)
    | WalletLoading
        { wallet : Cardano.Cip30.Wallet
        , utxos : List ( Cardano.Utxo.OutputReference, Cardano.Utxo.Output )
        }
    | WalletLoaded
        { wallet : Cardano.Cip30.Wallet
        , utxos : List ( Cardano.Utxo.OutputReference, Cardano.Utxo.Output )
        , changeAddress : Cardano.Address.Address
        }
    | Minted
        { wallet : Cardano.Cip30.Wallet
        , utxos : List ( Cardano.Utxo.OutputReference, Cardano.Utxo.Output )
        , changeAddress : Cardano.Address.Address
        }


init : () -> ( Model, Cmd Msg )
init _ =
    ( Startup
    , toWallet <| Cardano.Cip30.encodeRequest Cardano.Cip30.discoverWallets
    )



-- UPDATE


update : Msg -> Model -> ( Model, Cmd Msg )
update msg model =
    case ( msg, model ) of
        ( WalletMsg value, _ ) ->
            case ( Json.Decode.decodeValue Cardano.Cip30.responseDecoder value, model ) of
                -- We just discovered available wallets
                ( Ok (Cardano.Cip30.AvailableWallets wallets), Startup ) ->
                    ( WalletDiscovered wallets, Cmd.none )

                -- We just connected to the wallet, let’s ask for the available utxos
                ( Ok (Cardano.Cip30.EnabledWallet wallet), WalletDiscovered _ ) ->
                    ( WalletLoading { wallet = wallet, utxos = [] }
                    , toWallet <| Cardano.Cip30.encodeRequest <| Cardano.Cip30.getUtxos wallet { amount = Nothing, paginate = Nothing }
                    )

                -- We just received the utxos, let’s ask for the main change address of the wallet
                ( Ok (Cardano.Cip30.ApiResponse { walletId } (Cardano.Cip30.WalletUtxos utxos)), WalletLoading { wallet } ) ->
                    ( WalletLoading { wallet = wallet, utxos = utxos }
                    , toWallet (Cardano.Cip30.encodeRequest (Cardano.Cip30.getChangeAddress wallet))
                    )

                ( Ok (Cardano.Cip30.ApiResponse { walletId } (Cardano.Cip30.ChangeAddress address)), WalletLoading { wallet, utxos } ) ->
                    ( WalletLoaded { wallet = wallet, utxos = utxos, changeAddress = address }
                    , Cmd.none
                    )

                _ ->
                    ( model, Cmd.none )

        ( ConnectButtonClicked { id }, WalletDiscovered descriptors ) ->
            ( model, toWallet (Cardano.Cip30.encodeRequest (Cardano.Cip30.enableWallet { id = id, extensions = [] })) )

        ( Mint, WalletLoaded wallet ) ->
            case
                ( mintScriptResult mintScriptString
                , mintScriptFlatResult mintScriptFlatString
                )
            of
                ( Ok (Cardano.Script.Plutus mintScript), Ok (Cardano.Script.Plutus mintScriptFlat) ) ->
                    let
                        lockScript =
                            { hash = Cardano.Script.hash (Cardano.Script.Plutus mintScriptFlat)
                            , compiledCode = mintScript.script
                            }

                        tx =
                            mint
                                wallet
                                lockScript
                    in
                    case tx of
                        Ok goodTx ->
                            let
                                _ =
                                    Debug.log "goodTx " goodTx
                            in
                            ( Minted wallet
                            , toWallet
                                (Cardano.Cip30.encodeRequest
                                    (Cardano.Cip30.signTx wallet.wallet
                                        { partialSign = False }
                                        goodTx.tx
                                    )
                                )
                            )

                        Err e ->
                            let
                                _ =
                                    Debug.log "badTx " e
                            in
                            ( model, Cmd.none )

                _ ->
                    let
                        _ =
                            Debug.log "e " e
                    in
                    ( model, Cmd.none )

        _ ->
            ( model, Cmd.none )



-- VIEW


view : Model -> Html.Html Msg
view model =
    case model of
        Startup ->
            Html.div [] [ Html.div [] [ Html.text "Hello Cardano!" ] ]

        WalletDiscovered availableWallets ->
            Html.div []
                [ Html.div [] [ Html.text "Hello Cardano!" ]
                , Html.div [] [ Html.text "CIP-30 wallets detected:" ]
                , viewAvailableWallets availableWallets
                ]

        WalletLoading _ ->
            Html.div [] [ Html.text "Loading wallet assets ..." ]

        WalletLoaded { wallet, utxos, changeAddress } ->
            Html.div []
                [ Html.div [] [ Html.text <| "Wallet: " ++ (Cardano.Cip30.walletDescriptor wallet).name ]
                , Html.div [] [ Html.text <| "Address: " ++ (Cardano.Address.toBytes changeAddress |> Bytes.Comparable.toHex) ]
                , Html.div [] [ Html.text <| "UTxO count: " ++ String.fromInt (List.length utxos) ]
                , Html.button [ Html.Events.onClick Mint ] []
                ]

        _ ->
            Html.div [] []


viewAvailableWallets : List Cardano.Cip30.WalletDescriptor -> Html.Html Msg
viewAvailableWallets wallets =
    let
        walletDescription : Cardano.Cip30.WalletDescriptor -> String
        walletDescription w =
            "id: " ++ w.id ++ ", name: " ++ w.name

        walletIcon : Cardano.Cip30.WalletDescriptor -> Html.Html Msg
        walletIcon { icon } =
            Html.img [ Html.Attributes.src icon, Html.Attributes.height 32 ] []

        connectButton { id } =
            Html.button [ Html.Events.onClick (ConnectButtonClicked { id = id }) ] [ Html.text "connect" ]

        walletRow w =
            Html.div [] [ walletIcon w, Html.text (walletDescription w), connectButton w ]
    in
    Html.div [] (List.map walletRow wallets)


mint wallet { hash, compiledCode } =
    let
        mintedTokenAssetNameText =
            "aitoken"

        mintedTokenAssetName =
            Bytes.Comparable.fromText
                mintedTokenAssetNameText

        referenceTokenName =
            { label = 100
            , assetName = mintedTokenAssetName
            }

        plutusScriptWitness : Cardano.PlutusScriptWitness
        plutusScriptWitness =
            { script =
                ( Cardano.Script.PlutusV3
                , Cardano.WitnessValue compiledCode
                )
            , redeemerData = \_ -> Cardano.Data.Constr Natural.zero []
            , requiredSigners = []
            }

        scriptWitness : Cardano.ScriptWitness
        scriptWitness =
            Cardano.PlutusWitness
                plutusScriptWitness
    in
    [ Cardano.MintBurn
        { policyId = hash
        , assets =
            Bytes.Map.singleton (Cardano.Cip67.toBytes referenceTokenName)
                Integer.one
        , scriptWitness = scriptWitness
        }
    , Cardano.SendTo wallet.changeAddress
        (Cardano.Value.onlyToken hash
            (Cardano.Cip67.toBytes referenceTokenName)
            Natural.one
        )
    ]
        |> Cardano.finalize (localStateUtxos wallet.utxos)
            []


localStateUtxos : List ( Cardano.Utxo.OutputReference, a ) -> Cardano.Utxo.RefDict a
localStateUtxos myUtxos =
    Cardano.Utxo.refDictFromList myUtxos


mintScriptString : String
mintScriptString =
    "5915bc010100323232323232323232323232323232323232232329593333330132255333573466e1d20000021132593300122800c00400a002001486400644a66464645266666603a44aa666ae68cdc3a400000422b26601445001800801400400190c800c88c964c00400e42b26601e45001800801400400390c800c8964c01400a42b26602645001800801400400290c800c8964cc07c08400a42b26602e45001800801400400290c800c88c964c00400e42b26603845001800801400400390c800c88c8c964cc004c00401c01242b26604445001800801400400490c800c8964cc0b808000a42b26604c45001800801400400290c800c8964ccc0dc0d403c00a42b26605445001800801400400290c800c8964cccccc1088954ccd5cd19b87480000084564cc0bc8a0030010028008003219001912c999999823912a999ab9a3370e900000108ac9981a114006002005001000643200322593304801d00290ac9981c1140040080052159304900190c00600200700123002460048c0088c00823002280114008a004500200290ac9981991400400800521593333330492255333573466e1d200000211593303622800c00400a002000c86400644b26609403e00521593303a22800801000a42b2609600321800c00400e002460048c0091801118010460045002280114008a00400321800c00400e002460048c0091801118010460045002280114008a00400521593302e22800c00400a002001486400644b26607402400521593303222800c00400a002001486400644b2666086466666609644a64a666ae68cdc3a400000622b2660724500100200148564c06c00643001801800913002499130014982260029312992999ab9a3370e900100208ac9981d1140040080072159304500190c00601200244c0092644c00526089800a4c4a64a666ae68cdc3a400800a22b2660764500100200248564c12000643001803800913002499130014982260029312992999ab9a3370e900300308ac9981e11400600200500100164320032259302500290ac998201140040080052159303c00190c00600200700122600c9322600a93226008931130014982260029312992999ab9a3370e900400388ac9981e91400400800d2159303a00190c00601600244c0092644c00526089800a4c4aa666ae68cdc3a401400e22b26607a45001800801400400690c800c8964c09800a42b2660824500100200148564c0f000643001802801c0048c0091801230022300208c008a004500228011400800411000a42b26606c45001800801400400290c800c8964cc06412000a42b26607445001800801400400290c800c8964c07800a42b26607c45001800801400400290c800c8964ccc13c0f4cc13c14c8cccccc15c8954ccd5cd19b87480000084600300208aa999ab9a3370e900100108c0060081155333573466e1d200400211800c00023002280114008a004500200100290ac99821114006002005001000a43200322593304e03f00290ac99823114006002005001000a432003223259300100390ac998259140040080072159300300190c00600207f03b81bc0ca059028812408203901880a4042019008801c0048c009180123002182b017a300246004460048c0088c009180111801230022300246004460048c0088c009180111801230022300246004460048c008605c002a0648c0091801140b91801230022300246004460048c008602c466666604644aa666ae68cdc3a400000422b26602045001800801400400190c800c8964c07400a42b2660284500100200148564c08000643001800801c0048c0091801230022300208c008a004500228011400800518010460045002280114008a00400d21593300922800c00400a002003486400644b26601845001002000c8564cccccc088894c94ccd5cd19b874800000c4564cc0408a00200400290ac9a812000c860030030012260049322600293044c0052625325333573466e1d200200411593301122800c00400a002001c86400644b2603c00521593301522800801000a42b26604604a00321800c02400e00244c0192644c0152644c0112622600293044c0052625325333573466e1d200400511593301222800801001242b2603e00321800c01c0048980124c89800a4c11300149894c94ccd5cd19b87480180184564cc04c8a003001002800800b219001912c9a81500148564cc05c8a00200400290ac9809800c86003001003800913006499130054991300449889800a4c11300149894c94ccd5cd19b874802001c4564cc0508a00200400690ac9808800c8600300b0012260049322600293044c00526255333573466e1d200a00711593301422800c00400a002003486400644b26a05600521593301822800801000a42b2602600321800c01400e002460048c0091801118010460045002280114008a00400321800c00401a00900123002460044600480088cccccc0708954ccd5cd19b87480000084564cc0248a003001002800800321900191192c9800801c8564cc0388a0030010028008007219001912c980e80148564cc0488a00200400290ac999999814112992999ab9a3370e900000188ac9980b114006002005001000a43200322593302602b00290ac9980d114006002005001000a43200322593301d22800801000642b266056a06200321800c02401a00900122601293226010931130054991300449889800a4c11300149894c94ccd5cd19b87480080104564cc05c8a0030010028008007219001912c9981381600148564cc06c8a00200400290ac999999818912a999ab9a3370e900000108ac9980f11400600200500100064320032259301500290ac998111140040080052159301700190c00600200700123002460048c0088c00823002280114008a004500200190c00600200700122600c9322600a93226008931130014982260029312992999ab9a3370e900200288ac9980c1140060020050010012432003225933302902700f00290ac9980e11400400800521593302a503000190c00601600700122600c9322600a93226008931130014982260029312992999ab9a3370e900300308ac9980c91400400800b21593302702c00190c00600e00244c0092644c00526089800a4c4a64a666ae68cdc3a401000e22b26603445001800801400400690c800c8964cc0a80bc00a42b26603c45001800801400400290c800c8964cc0a80b400a42b26604445001800801400400290c800c8964ccc0cc0c406400a42b26604c450010020014856564cccccc0f08954ccd5cd19b87480000084564cc0a48a0030010028008003219001912c981000148564cc0b48a00200400290ac9811000c86003001003800918012300246004460041180114008a00450022801000c86400644aa666ae68cdc3a400000223002118009981800100091801243001806805c01e00700122601c9322601a93226018931130094991300849889802a4c8980224c44c00526089800a4c4a64a666ae68cdc3a401401022b26603645001800801400400790c800c8964cc0ac0c000a42b26603e4500100200148564cccccc0d48954ccd5cd19b87480000084564cc0888a00200400190ac99818281b000c860020028c00918010460045002280114008a00400321800c01400e00244c0192644c0152644c0112622600293044c00526255333573466e1d200c00811800c00823002280114008a004500200190c00600200f003800918012300246004460048c008a0408c00823002280114008a0045002001233333301b225325333573466e1d200000311593300922800c00400a002001486400644b2603000521593300d22800801000a42b266036a04400321800c03400e00244c0192644c0152644c0112622600293044c0052625325333573466e1d200200411593300a22800c00400a002001c86400644b2603200521593300e22800801000a42b266038a04600321800c04c00e00244c0192644c0152644c0112622600293044c005262532325333573466e1d200400611593300c22800c00400a002002c86400644b2603600521593301022800801000a42b2600e00321800c00c00e00244c0192644c0152644c0112622600293044c0052625325333573466e1d200600711593300d22800c00400a002003486400644b2603800521593301122800c00400a002001486400644b2601400521593301522800801000a42b26a05400321800c02c01e0070012260149322601293226010931130054991300449889800a4c11300149894c94ccd5cd19b87480200204564cc0388a003001002800800f219001912c980e80148564cc0488a00200400290ac9a813800c86003009003800913006499130054991300449889800a4c11300149894c94ccd5cd19b87480280244564cc03c8a00200400890ac980e000c860030150012260049322600293044c0052625325333573466e1d200c00a11593301022800c00400a002004c86400644b2603e00521593301422800801000a42b26a05200321800c04400e00244c0192644c0152644c0112622600293044c0052625325333573466e1d200e00b11593301122800c00400a00200548640064464b2600200721593301622800801000e42b2600600321800c01400e00244c01d2644c0192644c015262813a2600293044c0052625325333573466e1d201000c11593301222800c00400a002005c86400644b26a05000521593301622800801000a42b26a05600321800c01c00e00244c0192644c0152644c0112622600293044c0052625325333573466e1d201200d11593301322800c00400a002006486400644b2604400521593301722800801000a42b2604800321800c00400e00244c0192644c0152644c0112622600293044c00526255333573466e1d201400d11593301322800801003242b2604000321800c03c0048c0091801046004466666604044a64a666ae68cdc3a400000622b26601c4500100200148564d40880064300180080091300249913001498226002931299192999ab9a3370e900100288ac998081140040080092159300300190c00600a00244c0092644c00526089800a4c4aa666ae68cdc3a400800a22b26602045001800801400400490c800c8964d409800a42b2660284500100200148564c01c00643001801801c0048c0091801230022300208c0088cccccc090894c94ccd5cd19b874800000c4564cc0488a00200400290ac980f800c860030010012260049322600293044c00526255333573466e1d200200311800c00822aa666ae68cdc3a4008006230018020460045002280114008a0040025002280114008a0040025002280114008a004002466666603444a64a666ae68cdc3a400000622b2660104500100200148564c05400643001800800913002499130014982260029312992999ab9a3370e900100208ac998049140040080072159301600190c00600600244c0092644c00526089800a4c4aa666ae68cdc3a400800822b26601245001002001c8564d407400643001802800918012300208c008a004500228011400800460048c008602d0021180114008a00450022801001c860060028c0052411563616e6e6f74206465636f646520636f6e746578740024600466006921186572726f72206465636f64696e6720706172616d657465720080048c008cc00d2401186572726f72206465636f64696e6720706172616d6574657200800096400629344c0152410350543500112c800c6001133573800500218089112a999ab9a3370e900000088980224903505433001155333573466e200052000113300333702900000119b814800000444ca00266e1000c00666e100080046600a004002464c66ae70006000601e444aa666ae68cdc3a400000222004226600600266e180080048c8ccccc0388a00450020012801140094cc03c884cc042003000112c980280148564d4c0144800400a4300180180140048c0091328011a9802090008008480048cccccc0308954ccd5cd19b874800000844c964cc0048a0030010028008005219001912c9a80800148564cc0148a00200400290ac9a809800c8600300100380091801230024600446004300f80108c008a00450022801140080048cccccc02c8954ccd5cd19b874800000844c964cc0048a0030010028008005219001912c999999808912a999ab9a3370e900000108ac9980311400600200500100064320032259300d00290ac998051140040080052159330102333333019225325333573466e1d200000311593300f22800801000a42b2602800321800c0040048980124c89800a4c113001498954ccd5cd19b874800800c4564cc03c8a003001002800800521900191192c9800801c8564cc0508a0030010028008007219001912c980280148564cc0608a00200400290ac9803800c86003003007801c0048c0091801230022300246004501e460041180114008a00450022801000800c86003001003800918012300246004460041180114008a0045002280100148564cc0148a00300100280080052190019119192c998009800a80b00248564cc02c8a0030010028008009219001912c99999980d912a999ab9a3370e900000108c006000115325333573466e1d200200311593301122800801000a42b2601400321800c0140048980124c89800a4c113001498954ccd5cd19b874801000c4564cc0448a00200400290c006006002460041180114008a0045002280100148564cc03c8a00200400290ac9980a804000c8600300100d803c00e002460048c009180111801230021807800a809a30024600446004300e80108c008a00450022801140080048cccccc028894c94ccd5cd19b874800000c4564ccc03a0044500100200148564d403000643001800800913002499130014982260029312a999ab9a3370e900100188ac99980740088a00200400290ac9a806000c8600300300123002460041180114008a0045002280100091199999805112a999ab9a3370e900100108c0060041155333573466e1d2000002115933300d8011140040080032159300500190c006002002460048c00823002280114008a004500200122323333300a2280112c9801000c860020028c00850022801140094cc02c884cc032003000112c98031aab9d00290ac98031aab9e00390ac9a980309000801c86003003800801c0090012300244ca0046a600a24002004899194008d4c01448004008c014d55cf001048004a00200223333330062255333573466e1d200000211800c00822aa666ae68cdc3a4004004230018000460045002280114008a0040024466666600c44aa666ae68cdc3a4000004230018010454c94ccd5cd19b874800800c4564ccc02a0044500100200148564c01800643001800800913002499130014982260029312a999ab9a3370e900200188c0060081180114008a004500228010009199999802112a999ab9a3370e900000108992c99800914006002005001000a43200322593500800290ac9980291400400800521593500b00190c00600200700123002460048c0088c008600f0021180114008a00450022801000899999801114008a004500228011400400426666600245002280114008a00200228011111112999999aba40011323300735573a0026aae78004dd5000898029bab001130043758002260066eb40044c008dd70009112999aab9f0011003133002357420026ae880048c8c0040048c0088cc0080080041"


mintScriptFlatString : String
mintScriptFlatString =
    "010100323232323232323232323232323232323232232329593333330132255333573466e1d20000021132593300122800c00400a002001486400644a66464645266666603a44aa666ae68cdc3a400000422b26601445001800801400400190c800c88c964c00400e42b26601e45001800801400400390c800c8964c01400a42b26602645001800801400400290c800c8964cc07c08400a42b26602e45001800801400400290c800c88c964c00400e42b26603845001800801400400390c800c88c8c964cc004c00401c01242b26604445001800801400400490c800c8964cc0b808000a42b26604c45001800801400400290c800c8964ccc0dc0d403c00a42b26605445001800801400400290c800c8964cccccc1088954ccd5cd19b87480000084564cc0bc8a0030010028008003219001912c999999823912a999ab9a3370e900000108ac9981a114006002005001000643200322593304801d00290ac9981c1140040080052159304900190c00600200700123002460048c0088c00823002280114008a004500200290ac9981991400400800521593333330492255333573466e1d200000211593303622800c00400a002000c86400644b26609403e00521593303a22800801000a42b2609600321800c00400e002460048c0091801118010460045002280114008a00400321800c00400e002460048c0091801118010460045002280114008a00400521593302e22800c00400a002001486400644b26607402400521593303222800c00400a002001486400644b2666086466666609644a64a666ae68cdc3a400000622b2660724500100200148564c06c00643001801800913002499130014982260029312992999ab9a3370e900100208ac9981d1140040080072159304500190c00601200244c0092644c00526089800a4c4a64a666ae68cdc3a400800a22b2660764500100200248564c12000643001803800913002499130014982260029312992999ab9a3370e900300308ac9981e11400600200500100164320032259302500290ac998201140040080052159303c00190c00600200700122600c9322600a93226008931130014982260029312992999ab9a3370e900400388ac9981e91400400800d2159303a00190c00601600244c0092644c00526089800a4c4aa666ae68cdc3a401400e22b26607a45001800801400400690c800c8964c09800a42b2660824500100200148564c0f000643001802801c0048c0091801230022300208c008a004500228011400800411000a42b26606c45001800801400400290c800c8964cc06412000a42b26607445001800801400400290c800c8964c07800a42b26607c45001800801400400290c800c8964ccc13c0f4cc13c14c8cccccc15c8954ccd5cd19b87480000084600300208aa999ab9a3370e900100108c0060081155333573466e1d200400211800c00023002280114008a004500200100290ac99821114006002005001000a43200322593304e03f00290ac99823114006002005001000a432003223259300100390ac998259140040080072159300300190c00600207f03b81bc0ca059028812408203901880a4042019008801c0048c009180123002182b017a300246004460048c0088c009180111801230022300246004460048c0088c009180111801230022300246004460048c008605c002a0648c0091801140b91801230022300246004460048c008602c466666604644aa666ae68cdc3a400000422b26602045001800801400400190c800c8964c07400a42b2660284500100200148564c08000643001800801c0048c0091801230022300208c008a004500228011400800518010460045002280114008a00400d21593300922800c00400a002003486400644b26601845001002000c8564cccccc088894c94ccd5cd19b874800000c4564cc0408a00200400290ac9a812000c860030030012260049322600293044c0052625325333573466e1d200200411593301122800c00400a002001c86400644b2603c00521593301522800801000a42b26604604a00321800c02400e00244c0192644c0152644c0112622600293044c0052625325333573466e1d200400511593301222800801001242b2603e00321800c01c0048980124c89800a4c11300149894c94ccd5cd19b87480180184564cc04c8a003001002800800b219001912c9a81500148564cc05c8a00200400290ac9809800c86003001003800913006499130054991300449889800a4c11300149894c94ccd5cd19b874802001c4564cc0508a00200400690ac9808800c8600300b0012260049322600293044c00526255333573466e1d200a00711593301422800c00400a002003486400644b26a05600521593301822800801000a42b2602600321800c01400e002460048c0091801118010460045002280114008a00400321800c00401a00900123002460044600480088cccccc0708954ccd5cd19b87480000084564cc0248a003001002800800321900191192c9800801c8564cc0388a0030010028008007219001912c980e80148564cc0488a00200400290ac999999814112992999ab9a3370e900000188ac9980b114006002005001000a43200322593302602b00290ac9980d114006002005001000a43200322593301d22800801000642b266056a06200321800c02401a00900122601293226010931130054991300449889800a4c11300149894c94ccd5cd19b87480080104564cc05c8a0030010028008007219001912c9981381600148564cc06c8a00200400290ac999999818912a999ab9a3370e900000108ac9980f11400600200500100064320032259301500290ac998111140040080052159301700190c00600200700123002460048c0088c00823002280114008a004500200190c00600200700122600c9322600a93226008931130014982260029312992999ab9a3370e900200288ac9980c1140060020050010012432003225933302902700f00290ac9980e11400400800521593302a503000190c00601600700122600c9322600a93226008931130014982260029312992999ab9a3370e900300308ac9980c91400400800b21593302702c00190c00600e00244c0092644c00526089800a4c4a64a666ae68cdc3a401000e22b26603445001800801400400690c800c8964cc0a80bc00a42b26603c45001800801400400290c800c8964cc0a80b400a42b26604445001800801400400290c800c8964ccc0cc0c406400a42b26604c450010020014856564cccccc0f08954ccd5cd19b87480000084564cc0a48a0030010028008003219001912c981000148564cc0b48a00200400290ac9811000c86003001003800918012300246004460041180114008a00450022801000c86400644aa666ae68cdc3a400000223002118009981800100091801243001806805c01e00700122601c9322601a93226018931130094991300849889802a4c8980224c44c00526089800a4c4a64a666ae68cdc3a401401022b26603645001800801400400790c800c8964cc0ac0c000a42b26603e4500100200148564cccccc0d48954ccd5cd19b87480000084564cc0888a00200400190ac99818281b000c860020028c00918010460045002280114008a00400321800c01400e00244c0192644c0152644c0112622600293044c00526255333573466e1d200c00811800c00823002280114008a004500200190c00600200f003800918012300246004460048c008a0408c00823002280114008a0045002001233333301b225325333573466e1d200000311593300922800c00400a002001486400644b2603000521593300d22800801000a42b266036a04400321800c03400e00244c0192644c0152644c0112622600293044c0052625325333573466e1d200200411593300a22800c00400a002001c86400644b2603200521593300e22800801000a42b266038a04600321800c04c00e00244c0192644c0152644c0112622600293044c005262532325333573466e1d200400611593300c22800c00400a002002c86400644b2603600521593301022800801000a42b2600e00321800c00c00e00244c0192644c0152644c0112622600293044c0052625325333573466e1d200600711593300d22800c00400a002003486400644b2603800521593301122800c00400a002001486400644b2601400521593301522800801000a42b26a05400321800c02c01e0070012260149322601293226010931130054991300449889800a4c11300149894c94ccd5cd19b87480200204564cc0388a003001002800800f219001912c980e80148564cc0488a00200400290ac9a813800c86003009003800913006499130054991300449889800a4c11300149894c94ccd5cd19b87480280244564cc03c8a00200400890ac980e000c860030150012260049322600293044c0052625325333573466e1d200c00a11593301022800c00400a002004c86400644b2603e00521593301422800801000a42b26a05200321800c04400e00244c0192644c0152644c0112622600293044c0052625325333573466e1d200e00b11593301122800c00400a00200548640064464b2600200721593301622800801000e42b2600600321800c01400e00244c01d2644c0192644c015262813a2600293044c0052625325333573466e1d201000c11593301222800c00400a002005c86400644b26a05000521593301622800801000a42b26a05600321800c01c00e00244c0192644c0152644c0112622600293044c0052625325333573466e1d201200d11593301322800c00400a002006486400644b2604400521593301722800801000a42b2604800321800c00400e00244c0192644c0152644c0112622600293044c00526255333573466e1d201400d11593301322800801003242b2604000321800c03c0048c0091801046004466666604044a64a666ae68cdc3a400000622b26601c4500100200148564d40880064300180080091300249913001498226002931299192999ab9a3370e900100288ac998081140040080092159300300190c00600a00244c0092644c00526089800a4c4aa666ae68cdc3a400800a22b26602045001800801400400490c800c8964d409800a42b2660284500100200148564c01c00643001801801c0048c0091801230022300208c0088cccccc090894c94ccd5cd19b874800000c4564cc0488a00200400290ac980f800c860030010012260049322600293044c00526255333573466e1d200200311800c00822aa666ae68cdc3a4008006230018020460045002280114008a0040025002280114008a0040025002280114008a004002466666603444a64a666ae68cdc3a400000622b2660104500100200148564c05400643001800800913002499130014982260029312992999ab9a3370e900100208ac998049140040080072159301600190c00600600244c0092644c00526089800a4c4aa666ae68cdc3a400800822b26601245001002001c8564d407400643001802800918012300208c008a004500228011400800460048c008602d0021180114008a00450022801001c860060028c0052411563616e6e6f74206465636f646520636f6e746578740024600466006921186572726f72206465636f64696e6720706172616d657465720080048c008cc00d2401186572726f72206465636f64696e6720706172616d6574657200800096400629344c0152410350543500112c800c6001133573800500218089112a999ab9a3370e900000088980224903505433001155333573466e200052000113300333702900000119b814800000444ca00266e1000c00666e100080046600a004002464c66ae70006000601e444aa666ae68cdc3a400000222004226600600266e180080048c8ccccc0388a00450020012801140094cc03c884cc042003000112c980280148564d4c0144800400a4300180180140048c0091328011a9802090008008480048cccccc0308954ccd5cd19b874800000844c964cc0048a0030010028008005219001912c9a80800148564cc0148a00200400290ac9a809800c8600300100380091801230024600446004300f80108c008a00450022801140080048cccccc02c8954ccd5cd19b874800000844c964cc0048a0030010028008005219001912c999999808912a999ab9a3370e900000108ac9980311400600200500100064320032259300d00290ac998051140040080052159330102333333019225325333573466e1d200000311593300f22800801000a42b2602800321800c0040048980124c89800a4c113001498954ccd5cd19b874800800c4564cc03c8a003001002800800521900191192c9800801c8564cc0508a0030010028008007219001912c980280148564cc0608a00200400290ac9803800c86003003007801c0048c0091801230022300246004501e460041180114008a00450022801000800c86003001003800918012300246004460041180114008a0045002280100148564cc0148a00300100280080052190019119192c998009800a80b00248564cc02c8a0030010028008009219001912c99999980d912a999ab9a3370e900000108c006000115325333573466e1d200200311593301122800801000a42b2601400321800c0140048980124c89800a4c113001498954ccd5cd19b874801000c4564cc0448a00200400290c006006002460041180114008a0045002280100148564cc03c8a00200400290ac9980a804000c8600300100d803c00e002460048c009180111801230021807800a809a30024600446004300e80108c008a00450022801140080048cccccc028894c94ccd5cd19b874800000c4564ccc03a0044500100200148564d403000643001800800913002499130014982260029312a999ab9a3370e900100188ac99980740088a00200400290ac9a806000c8600300300123002460041180114008a0045002280100091199999805112a999ab9a3370e900100108c0060041155333573466e1d2000002115933300d8011140040080032159300500190c006002002460048c00823002280114008a004500200122323333300a2280112c9801000c860020028c00850022801140094cc02c884cc032003000112c98031aab9d00290ac98031aab9e00390ac9a980309000801c86003003800801c0090012300244ca0046a600a24002004899194008d4c01448004008c014d55cf001048004a00200223333330062255333573466e1d200000211800c00822aa666ae68cdc3a4004004230018000460045002280114008a0040024466666600c44aa666ae68cdc3a4000004230018010454c94ccd5cd19b874800800c4564ccc02a0044500100200148564c01800643001800800913002499130014982260029312a999ab9a3370e900200188c0060081180114008a004500228010009199999802112a999ab9a3370e900000108992c99800914006002005001000a43200322593500800290ac9980291400400800521593500b00190c00600200700123002460048c0088c008600f0021180114008a00450022801000899999801114008a004500228011400400426666600245002280114008a00200228011111112999999aba40011323300735573a0026aae78004dd5000898029bab001130043758002260066eb40044c008dd70009112999aab9f0011003133002357420026ae880048c8c0040048c0088cc0080080041"


mintScriptBytesResult mSS =
    case Bytes.Comparable.fromHex mSS of
        Just x ->
            Ok x

        Nothing ->
            Err "error converting mint script into bytes"


mintScriptFlatBytesResult mSS =
    case Bytes.Comparable.fromHex mSS of
        Just x ->
            Ok x

        Nothing ->
            Err "error converting mint script into bytes"


mintPlutusScriptResult : String -> Result String { version : Cardano.Script.PlutusVersion, script : Bytes.Comparable.Bytes a }
mintPlutusScriptResult mMSB =
    Result.map
        (\x ->
            { version = Cardano.Script.PlutusV3
            , script = x
            }
        )
        (mintScriptBytesResult mMSB)


mintFlatPlutusScriptResult mMSB =
    Result.map
        (\x ->
            { version = Cardano.Script.PlutusV3
            , script = x
            }
        )
        (mintScriptBytesResult mMSB)


mintScriptResult : String -> Result String Cardano.Script.Script
mintScriptResult mMSB =
    Result.map Cardano.Script.Plutus
        (mintPlutusScriptResult
            mMSB
        )


mintScriptFlatResult mMSB =
    Result.map Cardano.Script.Plutus
        (mintPlutusScriptResult
            mMSB
        )
